#include<bits/stdc++.h>
using namespace std;
void solve()
{
    int i,j,n=0,m=0,p=0,q=0,r=0,s=0,u=0,v=0,k=0,w=0,x=0,y=0; 
    char a[3][3];
    for(i=0;i<3;i++)
        {
            for(j=0;j<3;j++)
                cin>>a[i][j];
        }
    for(i=0;i<3;i++)
        {
            for(j=0;j<3;j++)
                {
                    if(a[i][j]=='X')
                        {u++;}
                    if(a[i][j]=='O')
                        {v++;}
                    if(a[i][j]=='_')
                        {y++;}
                }
        }
    //cout<<u<<v<<endl;
    if(a[0][0]==a[0][1]&&a[0][0]==a[0][2])
        {
            p++;
            if(a[0][0]=='X')
                w++;
            if(a[0][0]=='O')
                x++;
        }
    if(a[1][0]==a[1][1]&&a[1][0]==a[1][2])
        {
            p++;
            if(a[1][0]=='X')
                w++;
            if(a[1][0]=='O')
                x++;
        }
    if(a[2][0]==a[2][1]&&a[2][0]==a[2][2])
        {
            p++;
            if(a[2][0]=='X')
                w++;
            if(a[2][0]=='O')
                x++;
        }
    if(a[0][0]==a[1][0]&&a[0][0]==a[2][0])
        {
            p++;
            if(a[0][0]=='X')
                w++;
            if(a[0][0]=='O')
                x++;
        }
    if(a[0][1]==a[1][1]&&a[0][1]==a[2][1])
        {
            p++;
            if(a[0][1]=='X')
                w++;
            if(a[0][1]=='O')
                x++;
        }
    if(a[0][2]==a[1][2]&&a[0][2]==a[2][2])
        {
            p++;
            if(a[0][2]=='X')
                w++;
            if(a[0][2]=='O')
                x++;
        }
    if(a[0][0]==a[1][1]&&a[0][0]==a[2][2])
        {
            p++;
            if(a[0][0]=='X')
                w++;
            if(a[0][0]=='O')
                x++;
        }
    if(a[0][2]==a[1][1]&&a[0][2]==a[2][0])
        {
            p++;
            if(a[0][2]=='X')
                w++;
            if(a[0][2]=='O')
                x++;
        }
    //cout<<p<<"runnin"<<endl;
    if (p>=2&&w!=0&&x!=0)
        {cout<<3;k++;}
    if(((u-v)>1||(u-v)<0))
        {cout<<3;k++;}
        //{
            // if(u>v){v=v+y;}
            // if(v>u){u=u+y;}
            // if(((u-v)>1||(u-v)<0))
            
        //}
    if(p==1&&w==1&&u==v)
        {cout<<3; k++;}
    if(((w==0||x==0)&&(((u-v)==1)||((u-v)==0)))&&p>=2&&k==0)
        {cout<<1; k++; }
    if((p==0||p==1)&&k==0)
    {   
        if(p==0&&y==0)
            {
                cout<<1;
                k++;
            }
        else
        {
            hello:
            n=0,m=0,s=0;
            for(i=0;i<3;i++)
                {
                    for(j=0;j<3;j++)
                        {
                            if(a[i][j]=='_'&&u>v)
                                {
                                    a[i][j]='O';
                                    n=i;
                                    m=j;
                                    j=2;
                                    i=2;
                                    s++;
                                }
                            if(a[i][j]=='_'&&u==v)
                                {
                                    a[i][j]='X';
                                    n=i;
                                    m=j;
                                    j=2;
                                    i=2;
                                    s++;
                                }
                        }
                }
            // for(i=0;i<3;i++)
            //     {
            //         for(j=0;j<3;j++)
            //             {cout<<a[i][j];}
            //             cout<<endl;
            //     }
            if(a[0][0]==a[0][1]&&a[0][0]==a[0][2])
                {
                    cout<<1;
                    k++;
                }
            else if(a[1][0]==a[1][1]&&a[1][0]==a[1][2])
                {
                    cout<<1;
                    k++;
                }
            else if(a[2][0]==a[2][1]&&a[2][0]==a[2][2])
                {
                    cout<<1;
                    k++;
                }
            else if(a[0][0]==a[1][0]&&a[0][0]==a[2][0])
                {
                    cout<<1;
                    k++;
                }
            else if(a[0][1]==a[1][1]&&a[0][1]==a[2][1])
                {
                    cout<<1;
                    k++;
                }
            else if(a[0][2]==a[1][2]&&a[0][2]==a[2][2])
                {
                    cout<<1;
                    k++;
                }
            else if(a[0][0]==a[1][1]&&a[0][0]==a[2][2])
                {
                    cout<<1;
                    k++;
                }
            else if(a[0][2]==a[1][1]&&a[0][2]==a[2][0])
                {
                    cout<<1;
                    k++;
                }
            // else if(s!=0)
            //     {
            //         a[n][m]='O';
            //         if(a[0][0]==a[0][1]&&a[0][0]==a[0][2])
            //             {
            //                 cout<<1;
            //             }
            //         else if(a[1][0]==a[1][1]&&a[1][0]==a[1][2])
            //             {
            //                 cout<<1;
            //             }
            //         else if(a[2][0]==a[2][1]&&a[2][0]==a[2][2])
            //             {
            //                 cout<<1;
            //             }
            //         else if(a[0][0]==a[1][0]&&a[0][0]==a[2][0])
            //             {
            //                 cout<<1;
            //             }
            //         else if(a[0][1]==a[1][1]&&a[0][1]==a[2][1])
            //             {
            //                 cout<<1;
            //             }
            //         else if(a[0][2]==a[1][2]&&a[0][2]==a[2][2])
            //             {
            //                 cout<<1;
            //             }
            //         else if(a[0][0]==a[1][1]&&a[0][0]==a[2][2])
            //             {
            //                 cout<<1;
            //             }
            //         else if(a[0][2]==a[1][1]&&a[0][2]==a[2][0])
            //             {
            //                 cout<<1;
            //             }
            else if(s!=0)   
                        {
                            //cout<<"hello"<<endl;
                            a[n][m]='0';
                            r++;
                            goto hello;
                        }
            //      }
        }
    }
    if(k==0)
        {cout<<2;}    
}
int main()
{
    int t;
    cin>>t;
    for (int i=0;i<t;i++)
        {
            solve();
            cout<<endl;
        }
}




